{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { mapActions, mapState } from 'pinia';\nimport { useGuestStore } from '@/stores';\nimport axios from 'axios';\nexport default {\n  name: 'LogIn',\n  computed: {\n    ...mapState(useGuestStore, ['guest', 'isAuth', 'token'])\n  },\n  data() {\n    return {\n      name: '',\n      password: ''\n    };\n  },\n  mounted() {\n    // if user is authenticated \n    if (this.isAuth) {\n      // redirect him/her to the account view\n      this.$router.push('/account');\n    }\n    // set title\n    document.title = \"Log-In | Amin's portfolio\";\n  },\n  methods: {\n    // get actions from store\n    ...mapActions(useGuestStore, ['setToken', 'removeToken', 'loading', 'setUser']),\n    // after logging-in => get the user informations for later uses \n    async getuserinfo() {\n      await axios.get('/api/v1/users/me/').then(response => {\n        // set user informations to the store and to the local storage\n        this.setUser(response.data);\n      });\n    },\n    // submit form and login user\n    async submitform() {\n      this.loading(true);\n      axios.defaults.headers.common['Authorization'] = \"\";\n      this.removeToken();\n      if (this.name !== '' && this.password !== \"\") {\n        const formData = {\n          username: this.name,\n          password: this.password\n        };\n        // send form data to the server with post request\n        await axios.post('/api/v1/token/login/', formData).then(response => {\n          // get token from response data\n          const token = response.data.auth_token;\n          // set the token to the store and to the local storage\n          this.setToken(token);\n          // set the token to axios Authorization header\n          axios.defaults.headers.common['Authorization'] = \"Token \" + token;\n          this.getuserinfo(); // this function is the one above\n\n          // after successfully logged in redirect user to Home view\n          this.$router.push('/');\n          document.getElementById('sign').className.replace(\"none\", \"\");\n          document.getElementById('account').className += \"none\";\n        }).catch(error => {\n          alert('something went wrong!');\n        });\n      } else {\n        if (this.name !== '') {\n          alert('guestname field is empty!');\n        } else {\n          alert('password field is empty!');\n        }\n      }\n    }\n  }\n};","map":{"version":3,"names":["mapActions","mapState","useGuestStore","axios","name","computed","data","password","mounted","isAuth","$router","push","document","title","methods","getuserinfo","get","then","response","setUser","submitform","loading","defaults","headers","common","removeToken","formData","username","post","token","auth_token","setToken","getElementById","className","replace","catch","error","alert"],"sources":["C:\\Users\\SBS\\Desktop\\amin.projects\\My-Portfolio\\portfolio\\src\\views\\LogIn.vue"],"sourcesContent":["<template>\r\n    <div class=\"login\">\r\n        <form @submit.prevent=\"submitform\">\r\n            <label for=\"guestname\">Guestname</label>\r\n            <input type=\"text\" id=\"guestname\" placeholder=\"Your name...\" v-model=\"name\">\r\n            <label for=\"guestname\">Password</label>\r\n            <input type=\"password\" id=\"guestname\" placeholder=\"Your password...\" v-model=\"password\">\r\n            <input type=\"submit\" id=\"submit\" value=\"Sign-Up\">\r\n        </form>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport { mapActions, mapState } from 'pinia';\r\nimport { useGuestStore } from '@/stores';\r\nimport axios from 'axios';\r\n\r\n    export default {\r\n        name: 'LogIn',\r\n        computed: {\r\n            ...mapState(useGuestStore, ['guest', 'isAuth', 'token'])\r\n        },\r\n        data(){\r\n            return{\r\n                name: '',\r\n                password: ''\r\n            }\r\n        },\r\n        mounted(){\r\n            // if user is authenticated \r\n            if(this.isAuth){\r\n                // redirect him/her to the account view\r\n                this.$router.push('/account')\r\n            }\r\n            // set title\r\n            document.title = \"Log-In | Amin's portfolio\";\r\n            \r\n            \r\n        },\r\n        methods: {\r\n            // get actions from store\r\n            ...mapActions(useGuestStore, ['setToken', 'removeToken', 'loading', 'setUser']),\r\n\r\n            // after logging-in => get the user informations for later uses \r\n            async getuserinfo(){\r\n                await axios\r\n                    .get('/api/v1/users/me/')\r\n                    .then(response=>{\r\n                        // set user informations to the store and to the local storage\r\n                        this.setUser(response.data)\r\n                    })\r\n            },\r\n\r\n            // submit form and login user\r\n            async submitform(){\r\n                this.loading(true);\r\n\r\n                axios.defaults.headers.common['Authorization'] = \"\" \r\n                this.removeToken()\r\n\r\n                if(this.name !== '' && this.password !== \"\"){\r\n                    const formData= {\r\n                        username: this.name,\r\n                        password: this.password\r\n                    }\r\n                    // send form data to the server with post request\r\n                    await axios\r\n                        .post('/api/v1/token/login/', formData)\r\n                        .then(response=>{\r\n                            // get token from response data\r\n                            const token = response.data.auth_token;\r\n                            // set the token to the store and to the local storage\r\n                            this.setToken(token)\r\n                            // set the token to axios Authorization header\r\n                            axios.defaults.headers.common['Authorization'] = \"Token \" + token\r\n\r\n                            this.getuserinfo() // this function is the one above\r\n\r\n                            // after successfully logged in redirect user to Home view\r\n                            this.$router.push('/')\r\n                            document.getElementById('sign').className.replace(\"none\", \"\")\r\n                            document.getElementById('account').className += \"none\"\r\n                            \r\n                        })\r\n                        .catch(error=>{\r\n                            alert('something went wrong!')\r\n                        })\r\n\r\n                } else {\r\n                    if(this.name !== ''){\r\n                        alert('guestname field is empty!')\r\n                    } else{\r\n                        alert('password field is empty!')\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n</script>"],"mappings":";AAaA,SAASA,UAAU,EAAEC,QAAO,QAAS,OAAO;AAC5C,SAASC,aAAY,QAAS,UAAU;AACxC,OAAOC,KAAI,MAAO,OAAO;AAErB,eAAe;EACXC,IAAI,EAAE,OAAO;EACbC,QAAQ,EAAE;IACN,GAAGJ,QAAQ,CAACC,aAAa,EAAE,CAAC,OAAO,EAAE,QAAQ,EAAE,OAAO,CAAC;EAC3D,CAAC;EACDI,IAAIA,CAAA,EAAE;IACF,OAAM;MACFF,IAAI,EAAE,EAAE;MACRG,QAAQ,EAAE;IACd;EACJ,CAAC;EACDC,OAAOA,CAAA,EAAE;IACL;IACA,IAAG,IAAI,CAACC,MAAM,EAAC;MACX;MACA,IAAI,CAACC,OAAO,CAACC,IAAI,CAAC,UAAU;IAChC;IACA;IACAC,QAAQ,CAACC,KAAI,GAAI,2BAA2B;EAGhD,CAAC;EACDC,OAAO,EAAE;IACL;IACA,GAAGd,UAAU,CAACE,aAAa,EAAE,CAAC,UAAU,EAAE,aAAa,EAAE,SAAS,EAAE,SAAS,CAAC,CAAC;IAE/E;IACA,MAAMa,WAAWA,CAAA,EAAE;MACf,MAAMZ,KAAI,CACLa,GAAG,CAAC,mBAAmB,EACvBC,IAAI,CAACC,QAAQ,IAAE;QACZ;QACA,IAAI,CAACC,OAAO,CAACD,QAAQ,CAACZ,IAAI;MAC9B,CAAC;IACT,CAAC;IAED;IACA,MAAMc,UAAUA,CAAA,EAAE;MACd,IAAI,CAACC,OAAO,CAAC,IAAI,CAAC;MAElBlB,KAAK,CAACmB,QAAQ,CAACC,OAAO,CAACC,MAAM,CAAC,eAAe,IAAI,EAAC;MAClD,IAAI,CAACC,WAAW,EAAC;MAEjB,IAAG,IAAI,CAACrB,IAAG,KAAM,EAAC,IAAK,IAAI,CAACG,QAAO,KAAM,EAAE,EAAC;QACxC,MAAMmB,QAAQ,GAAE;UACZC,QAAQ,EAAE,IAAI,CAACvB,IAAI;UACnBG,QAAQ,EAAE,IAAI,CAACA;QACnB;QACA;QACA,MAAMJ,KAAI,CACLyB,IAAI,CAAC,sBAAsB,EAAEF,QAAQ,EACrCT,IAAI,CAACC,QAAQ,IAAE;UACZ;UACA,MAAMW,KAAI,GAAIX,QAAQ,CAACZ,IAAI,CAACwB,UAAU;UACtC;UACA,IAAI,CAACC,QAAQ,CAACF,KAAK;UACnB;UACA1B,KAAK,CAACmB,QAAQ,CAACC,OAAO,CAACC,MAAM,CAAC,eAAe,IAAI,QAAO,GAAIK,KAAI;UAEhE,IAAI,CAACd,WAAW,EAAC,EAAE;;UAEnB;UACA,IAAI,CAACL,OAAO,CAACC,IAAI,CAAC,GAAG;UACrBC,QAAQ,CAACoB,cAAc,CAAC,MAAM,CAAC,CAACC,SAAS,CAACC,OAAO,CAAC,MAAM,EAAE,EAAE;UAC5DtB,QAAQ,CAACoB,cAAc,CAAC,SAAS,CAAC,CAACC,SAAQ,IAAK,MAAK;QAEzD,CAAC,EACAE,KAAK,CAACC,KAAK,IAAE;UACVC,KAAK,CAAC,uBAAuB;QACjC,CAAC;MAET,OAAO;QACH,IAAG,IAAI,CAACjC,IAAG,KAAM,EAAE,EAAC;UAChBiC,KAAK,CAAC,2BAA2B;QACrC,OAAM;UACFA,KAAK,CAAC,0BAA0B;QACpC;MACJ;IACJ;EACJ;AACJ"},"metadata":{},"sourceType":"module","externalDependencies":[]}